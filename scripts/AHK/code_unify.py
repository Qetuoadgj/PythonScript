# -*- coding: utf-8 -*-

console.show()
console.clear()

import re

DocumentStartingPosition = editor.getCurrentPos()

# editor.documentStart()
# editor.documentEnd()
# editor.selectAll()

CaseTable = [
	'ClipboardTimeout',
	'CommentFlag',
	'ErrorStdOut',
	'EscapeChar',
	'HotkeyInterval',
	'HotkeyModifierTimeout',
	'Hotstring',
	'if',
	'IfTimeout',
	'IfWinActive',
	'IfWinExist',
	'IfWinNotActive',
	'IfWinNotExist',
	'Include',
	'IncludeAgain',
	'InputLevel',
	'InstallKeybdHook',
	'InstallMouseHook',
	'KeyHistory',
	'LTrim',
	'MaxHotkeysPerInterval',
	'MaxMem',
	'MaxThreads',
	'MaxThreadsBuffer',
	'MaxThreadsPerHotkey',
	'MenuMaskKey',
	'NoEnv',
	'NoTrayIcon',
	'Persistent',
	'SingleInstance',
	'UseHook',
	'Warn',
	'WinActivateForce',
	'AutoTrim',
	'BlockInput',
	'break',
	'Click',
	'ClipWait',
	'catch',
	'continue',
	'Control',
	'ControlClick',
	'ControlFocus',
	'ControlGet',
	'ControlGetFocus',
	'ControlGetPos',
	'ControlGetText',
	'ControlMove',
	'ControlSend',
	'ControlSendRaw',
	'ControlSetText',
	'CoordMode',
	'Critical',
	'DetectHiddenText',
	'DetectHiddenWindows',
	'Drive',
	'DriveGet',
	'DriveSpaceFree',
	'Edit',
	'else',
	'EnvAdd',
	'EnvDiv',
	'EnvGet',
	'EnvMult',
	'EnvSet',
	'EnvSub',
	'EnvUpdate',
	'Exit',
	'ExitApp',
	'FileAppend',
	'FileCopy',
	'FileCopyDir',
	'FileCreateDir',
	'FileCreateShortcut',
	'FileDelete',
	'FileEncoding',
	'FileGetAttrib',
	'FileGetShortcut',
	'FileGetSize',
	'FileGetTime',
	'FileGetVersion',
	'FileInstall',
	'FileMove',
	'FileMoveDir',
	'FileRead',
	'FileReadLine',
	'FileRecycle',
	'FileRecycleEmpty',
	'FileRemoveDir',
	'FileSelectFile',
	'FileSelectFolder',
	'FileSetAttrib',
	'FileSetTime',
	'finally',
	'for',
	'FormatTime',
	'GetKeyState',
	'gosub',
	'goto',
	'GroupActivate',
	'GroupAdd',
	'GroupClose',
	'GroupDeactivate',
	'Gui',
	'GuiControl',
	'GuiControlGet',
	'Hotkey',
	'IfEqual',
	'IfExist',
	'IfGreater',
	'IfGreaterOrEqual',
	'IfInString',
	'IfLess',
	'IfLessOrEqual',
	'IfMsgBox',
	'IfNotEqual',
	'IfNotExist',
	'IfNotInString',
	'ImageSearch',
	'IniDelete',
	'IniRead',
	'IniWrite',
	'Input',
	'InputBox',
	'KeyWait',
	'ListHotkeys',
	'ListLines',
	'ListVars',
	'Loop',
	'Menu',
	'MouseClick',
	'MouseClickDrag',
	'MouseGetPos',
	'MouseMove',
	'MsgBox',
	'OnExit',
	'OutputDebug',
	'Pause',
	'PixelGetColor',
	'PixelSearch',
	'PostMessage',
	'Process',
	'Progress',
	'Random',
	'RegDelete',
	'RegRead',
	'RegWrite',
	'Reload',
	'return',
	'Run',
	'RunAs',
	'RunWait',
	'Send',
	'SendEvent',
	'SendInput',
	'SendLevel',
	'SendMessage',
	'SendMode',
	'SendPlay',
	'SendRaw',
	'SetBatchLines',
	'SetCapsLockState',
	'SetControlDelay',
	'SetDefaultMouseSpeed',
	'SetEnv',
	'SetFormat',
	'SetKeyDelay',
	'SetMouseDelay',
	'SetNumLockState',
	'SetRegView',
	'SetScrollLockState',
	'SetStoreCapslockMode',
	'SetTimer',
	'SetTitleMatchMode',
	'SetWinDelay',
	'SetWorkingDir',
	'Shutdown',
	'Sleep',
	'Sort',
	'SoundBeep',
	'SoundGet',
	'SoundGetWaveVolume',
	'SoundPlay',
	'SoundSet',
	'SoundSetWaveVolume',
	'SplashImage',
	'SplashTextOff',
	'SplashTextOn',
	'SplitPath',
	'StatusBarGetText',
	'StatusBarWait',
	'StringCaseSense',
	'StringGetPos',
	'StringLeft',
	'StringLen',
	'StringLower',
	'StringMid',
	'StringReplace',
	'StringRight',
	'StringSplit',
	'StringTrimLeft',
	'StringTrimRight',
	'StringUpper',
	'Suspend',
	'SysGet',
	'Thread',
	'throw',
	'ToolTip',
	'Transform',
	'TrayTip',
	'try',
	'until',
	'URLDownloadToFile',
	'while',
	'WinActivate',
	'WinActivateBottom',
	'WinClose',
	'WinGet',
	'WinGetActiveStats',
	'WinGetActiveTitle',
	'WinGetClass',
	'WinGetPos',
	'WinGetText',
	'WinGetTitle',
	'WinHide',
	'WinKill',
	'WinMaximize',
	'WinMenuSelectItem',
	'WinMinimize',
	'WinMinimizeAll',
	'WinMinimizeAllUndo',
	'WinMove',
	'WinRestore',
	'WinSet',
	'WinSetTitle',
	'WinShow',
	'WinWait',
	'WinWaitActive',
	'WinWaitClose',
	'WinWaitNotActive',
	'Abs',
	'ACos',
	'Asc',
	'ASin',
	'ATan',
	'Ceil',
	'Chr',
	'Cos',
	'DllCall',
	'Exception',
	'Exp',
	'FileExist',
	'Floor',
	'ILAdd',
	'ILCreate',
	'ILDestroy',
	'InStr',
	'IsFunc',
	'IsLabel',
	'Ln',
	'Log',
	'LVAdd',
	'LVDelete',
	'LVDeleteCol',
	'LVGetCount',
	'LVGetNext',
	'LVGetText',
	'LVInsert',
	'LVInsertCol',
	'LVModify',
	'LVModifyCol',
	'LVSetImageList',
	'Mod',
	'NumGet',
	'NumPut',
	'OnMessage',
	'RegExMatch',
	'RegExReplace',
	'RegisterCallback',
	'Round',
	'SBSetIcon',
	'SBSetParts',
	'SBSetText',
	'Sin',
	'Sqrt',
	'StrLen',
	'SubStr',
	'StrSplit',
	'Tan',
	'TVAdd',
	'TVDelete',
	'TVGetChild',
	'TVGetCount',
	'TVGetNext',
	'TVGet',
	'TVGetParent',
	'TVGetPrev',
	'TVGetSelection',
	'TVGetText',
	'TVModify',
	'TVSetImageList',
	'VarSetCapacity',
	'WinActive',
	'WinExist',
	'Trim',
	'RTrim',
	'FileOpen',
	'StrGet',
	'StrPut',
	'GetKeyName',
	'GetKeyVK',
	'GetKeySC',
	'IsByRef',
	'Object',
	'Array',
	'IsObject',
	'ObjInsert',
	'ObjRemove',
	'ObjMinIndex',
	'ObjMaxIndex',
	'ObjSetCapacity',
	'ObjGetCapacity',
	'ObjGetAddress',
	'ObjNewEnum',
	'ObjAddRef',
	'ObjRelease',
	'ObjHasKey',
	'ObjClone',
	'Get',
	'Set',
	'Call',
	'Delete',
	'New',
	'NewEnum',
	'class',
	'extends',
	'ComObjCreate',
	'ComObjGet',
	'ComObjConnect',
	'ComObjError',
	'ComObjActive',
	'ComObject',
	'ComObjMissing',
	'ComObjEnwrap',
	'ComObjUnwrap',
	'ComObjType',
	'ComObjValue',
	'ComObjArray',
	'ComObjQuery',
	'ComObjFlags',
	'Func',
	'Clone',
	'GetAddress',
	'GetCapacity',
	'HasKey',
	'Insert',
	'MaxIndex',
	'MinIndex',
	'Remove',
	'SetCapacity',
	'Read',
	'Write',
	'ReadLine',
	'WriteLine',
	'RawRead',
	'RawWrite',
	'ReadUChar',
	'ReadChar',
	'ReadUShort',
	'ReadShort',
	'ReadUInt',
	'ReadInt',
	'ReadInt64',
	'ReadFloat',
	'ReadDouble',
	'WriteUChar',
	'WriteChar',
	'WriteUShort',
	'WriteShort',
	'WriteUInt',
	'WriteInt',
	'WriteInt64',
	'WriteFloat',
	'WriteDouble',
	'Seek',
	'Position',
	'Pos',
	'AtEOF',
	'Close',
	'Encoding',
	'Handle',
	'Name',
	'IsBuiltIn',
	'IsVariadic',
	'MinParams',
	'MaxParams',
	'IsOptional',
	'Shift',
	'LShift',
	'RShift',
	'Alt',
	'LAlt',
	'RAlt',
	'LControl',
	'RControl',
	'Ctrl',
	'LCtrl',
	'RCtrl',
	'LWin',
	'RWin',
	'AppsKey',
	'AltDown',
	'AltUp',
	'ShiftDown',
	'ShiftUp',
	'CtrlDown',
	'CtrlUp',
	'LWinDown',
	'LWinUp',
	'RWinDown',
	'RWinUp',
	'LButton',
	'RButton',
	'MButton',
	'WheelUp',
	'WheelDown',
	'WheelLeft',
	'WheelRight',
	'XButton1',
	'XButton2',
	'Joy1',
	'Joy2',
	'Joy3',
	'Joy4',
	'Joy5',
	'Joy6',
	'Joy7',
	'Joy8',
	'Joy9',
	'Joy10',
	'Joy11',
	'Joy12',
	'Joy13',
	'Joy14',
	'Joy15',
	'Joy16',
	'Joy17',
	'Joy18',
	'Joy19',
	'Joy20',
	'Joy21',
	'Joy22',
	'Joy23',
	'Joy24',
	'Joy25',
	'Joy26',
	'Joy27',
	'Joy28',
	'Joy29',
	'Joy30',
	'Joy31',
	'Joy32',
	'JoyX',
	'JoyY',
	'JoyZ',
	'JoyR',
	'JoyU',
	'JoyV',
	'JoyPOV',
	'JoyName',
	'JoyButtons',
	'JoyAxes',
	'JoyInfo',
	'Space',
	'Tab',
	'Enter',
	'Escape',
	'Esc',
	'BackSpace',
	'Del',
	'Ins',
	'PGUP',
	'PGDN',
	'Home',
	'End',
	'Up',
	'Down',
	'Left',
	'Right',
	'PrintScreen',
	'CtrlBreak',
	'ScrollLock',
	'CapsLock',
	'NumLock',
	'Numpad0',
	'Numpad1',
	'Numpad2',
	'Numpad3',
	'Numpad4',
	'Numpad5',
	'Numpad6',
	'Numpad7',
	'Numpad8',
	'Numpad9',
	'NumpadMult',
	'NumpadAdd',
	'NumpadSub',
	'NumpadDiv',
	'NumpadDot',
	'NumpadDel',
	'NumpadIns',
	'NumpadClear',
	'NumpadUp',
	'NumpadDown',
	'NumpadLeft',
	'NumpadRight',
	'NumpadHome',
	'NumpadEnd',
	'NumpadPgup',
	'NumpadPgdn',
	'NumpadEnter',
	'F1',
	'F2',
	'F3',
	'F4',
	'F5',
	'F6',
	'F7',
	'F8',
	'F9',
	'F10',
	'F11',
	'F12',
	'F13',
	'F14',
	'F15',
	'F16',
	'F17',
	'F18',
	'F19',
	'F20',
	'F21',
	'F22',
	'F23',
	'F24',
	'BrowserBack',
	'BrowserForward',
	'BrowserRefresh',
	'BrowserStop',
	'BrowserSearch',
	'BrowserFavorites',
	'BrowserHome',
	'VolumeMute',
	'VolumeDown',
	'VolumeUp',
	'MediaNext',
	'MediaPrev',
	'MediaStop',
	'MediaPlayPause',
	'LaunchMail',
	'LaunchMedia',
	'LaunchApp1',
	'LaunchApp2',
	'Pixel',
	'Mouse',
	'Screen',
	'Relative',
	'RGB',
	'Join',
	'Low',
	'BelowNormal',
	'Normal',
	'AboveNormal',
	'High',
	'Realtime',
	'ahkid',
	'ahkpid',
	'ahkclass',
	'ahkgroup',
	'ahkexe',
	'between',
	'contains',
	'in',
	'Integer',
	'Float',
	'IntegerFast',
	'FloatFast',
	'number',
	'digit',
	'xdigit',
	'alpha',
	'upper',
	'lower',
	'alnum',
	'time',
	'date',
	'not',
	'or',
	'and',
	'AlwaysOnTop',
	'Topmost',
	'Top',
	'Bottom',
	'Transparent',
	'TransColor',
	'Redraw',
	'Region',
	'ID',
	'IDLast',
	'ProcessName',
	'ProcessPath',
	'MinMax',
	'ControlList',
	'Count',
	'List',
	'Capacity',
	'StatusCD',
	'Eject',
	'Lock',
	'Unlock',
	'Label',
	'FileSystem',
	'SetLabel',
	'Serial',
	'Type',
	'Status',
	'static',
	'global',
	'local',
	'ByRef',
	'Seconds',
	'Minutes',
	'Hours',
	'Days',
	'Parse',
	'Logoff',
	'Error',
	'Single',
	'Tray',
	'Add',
	'Rename',
	'Check',
	'UnCheck',
	'ToggleCheck',
	'Enable',
	'Disable',
	'ToggleEnable',
	'Default',
	'NoDefault',
	'Standard',
	'NoStandard',
	'Color',
	'DeleteAll',
	'Icon',
	'NoIcon',
	'Tip',
	'Show',
	'MainWindow',
	'NoMainWindow',
	'UseErrorLevel',
	'Text',
	'Picture',
	'Pic',
	'GroupBox',
	'Button',
	'Checkbox',
	'Radio',
	'DropDownList',
	'DDL',
	'ComboBox',
	'ListBox',
	'ListView',
	'DateTime',
	'MonthCal',
	'Slider',
	'StatusBar',
	'Tab2',
	'TreeView',
	'UpDown',
	'ActiveX',
	'Link',
	'Custom',
	'IconSmall',
	'Tile',
	'Report',
	'SortDesc',
	'NoSort',
	'NoSortHdr',
	'Grid',
	'Hdr',
	'AutoSize',
	'Range',
	'Font',
	'Resize',
	'Owner',
	'Submit',
	'NoHide',
	'Minimize',
	'Maximize',
	'Restore',
	'NoActivate',
	'NA',
	'Cancel',
	'Destroy',
	'Center',
	'DPIScale',
	'Margin',
	'MaxSize',
	'MinSize',
	'OwnDialogs',
	'GuiEscape',
	'GuiClose',
	'GuiSize',
	'GuiContextMenu',
	'GuiDropFiles',
	'OnClipboardChange',
	'TabStop',
	'Section',
	'AltSubmit',
	'Wrap',
	'HScroll',
	'VScroll',
	'Border',
	'Buttons',
	'Expand',
	'First',
	'ImageList',
	'Lines',
	'WantCtrlA',
	'WantF2',
	'Vis',
	'VisFirst',
	'Uppercase',
	'Lowercase',
	'Limit',
	'Password',
	'Multi',
	'WantReturn',
	'Group',
	'Background',
	'bold',
	'italic',
	'strike',
	'underline',
	'norm',
	'BackgroundTrans',
	'Theme',
	'Caption',
	'Delimiter',
	'MinimizeBox',
	'MaximizeBox',
	'SysMenu',
	'ToolWindow',
	'Flash',
	'Style',
	'ExStyle',
	'Check3',
	'Checked',
	'CheckedGray',
	'ReadOnly',
	'Hidden',
	'NoTab',
	'Move',
	'Focus',
	'Hide',
	'Choose',
	'ChooseString',
	'Enabled',
	'Disabled',
	'Visible',
	'LastFound',
	'LastFoundExist',
	'AltTab',
	'ShiftAltTab',
	'AltTabMenu',
	'AltTabAndMenu',
	'AltTabMenuDismiss',
	'NoTimers',
	'Interrupt',
	'Priority',
	'WaitClose',
	'Wait',
	'Exist',
	'Blind',
	'Raw',
	'Unicode',
	'ToCodePage',
	'FromCodePage',
	'Deref',
	'Pow',
	'BitNot',
	'BitAnd',
	'BitOr',
	'BitXOr',
	'BitShiftLeft',
	'BitShiftRight',
	'Yes',
	'No',
	'Ok',
	'Abort',
	'Retry',
	'Ignore',
	'TryAgain',
	'On',
	'Off',
	'All',
	'HKEYLOCALMACHINE',
	'HKEYUSERS',
	'HKEYCURRENTUSER',
	'HKEYCLASSESROOT',
	'HKEYCURRENTCONFIG',
	'HKLM',
	'HKU',
	'HKCU',
	'HKCR',
	'HKCC',
	'REGSZ',
	'REGEXPANDSZ',
	'REGMULTISZ',
	'REGDWORD',
	'REGBINARY',
	'UseUnsetLocal',
	'UseUnsetGlobal',
	'UseEnv',
	'LocalSameAsGlobal',
	'AAhkPath',
	'AAhkVersion',
	'AAppData',
	'AAppDataCommon',
	'AAutoTrim',
	'ABatchLines',
	'ACaretX',
	'ACaretY',
	'AComputerName',
	'AControlDelay',
	'ACursor',
	'ADDD',
	'ADDDD',
	'ADefaultMouseSpeed',
	'ADesktop',
	'ADesktopCommon',
	'ADetectHiddenText',
	'ADetectHiddenWindows',
	'AEndChar',
	'AEventInfo',
	'AExitReason',
	'AFileEncoding',
	'AFormatFloat',
	'AFormatInteger',
	'AGui',
	'AGuiEvent',
	'AGuiControl',
	'AGuiControlEvent',
	'AGuiHeight',
	'AGuiWidth',
	'AGuiX',
	'AGuiY',
	'AHour',
	'AIconFile',
	'AIconHidden',
	'AIconNumber',
	'AIconTip',
	'AIndex',
	'AIPAddress1',
	'AIPAddress2',
	'AIPAddress3',
	'AIPAddress4',
	'AIs64bitOS',
	'AIsAdmin',
	'AIsCompiled',
	'AIsCritical',
	'AIsPaused',
	'AIsSuspended',
	'AIsUnicode',
	'AKeyDelay',
	'ALanguage',
	'ALastError',
	'ALineFile',
	'ALineNumber',
	'ALoopField',
	'ALoopFileAttrib',
	'ALoopFileDir',
	'ALoopFileExt',
	'ALoopFileFullPath',
	'ALoopFileLongPath',
	'ALoopFileName',
	'ALoopFileShortName',
	'ALoopFileShortPath',
	'ALoopFileSize',
	'ALoopFileSizeKB',
	'ALoopFileSizeMB',
	'ALoopFileTimeAccessed',
	'ALoopFileTimeCreated',
	'ALoopFileTimeModified',
	'ALoopReadLine',
	'ALoopRegKey',
	'ALoopRegName',
	'ALoopRegSubkey',
	'ALoopRegTimeModified',
	'ALoopRegType',
	'AMDay',
	'AMin',
	'AMM',
	'AMMM',
	'AMMMM',
	'AMon',
	'AMouseDelay',
	'AMSec',
	'AMyDocuments',
	'ANow',
	'ANowUTC',
	'ANumBatchLines',
	'AOSType',
	'AOSVersion',
	'APriorHotkey',
	'APriorKey',
	'AProgramFiles',
	'APrograms',
	'AProgramsCommon',
	'APtrSize',
	'ARegView',
	'AScreenDPI',
	'AScreenHeight',
	'AScreenWidth',
	'AScriptDir',
	'AScriptFullPath',
	'AScriptHwnd',
	'AScriptName',
	'ASec',
	'ASpace',
	'AStartMenu',
	'AStartMenuCommon',
	'AStartup',
	'AStartupCommon',
	'AStringCaseSense',
	'ATab',
	'ATemp',
	'AThisFunc',
	'AThisHotkey',
	'AThisLabel',
	'AThisMenu',
	'AThisMenuItem',
	'AThisMenuItemPos',
	'ATickCount',
	'ATimeIdle',
	'ATimeIdlePhysical',
	'ATimeSincePriorHotkey',
	'ATimeSinceThisHotkey',
	'ATitleMatchMode',
	'ATitleMatchModeSpeed',
	'AUserName',
	'AWDay',
	'AWinDelay',
	'AWinDir',
	'AWorkingDir',
	'AYDay',
	'AYear',
	'AYWeek',
	'AYYYY',
	'Clipboard',
	'ClipboardAll',
	'ComSpec',
	'ErrorLevel',
	'ProgramFiles',
	'true',
	'false'
]

CommaCommandsTable = [
	'#IfWinActive',
	'#IfWinExist',
	'#IfWinNotActive',
	'#IfWinNotExist',
	'#InputLevel',
	'AutoTrim',
	'BlockInput',
	'break',
	'ClipWait',
	'catch',
	'continue',
	'Control',
	'ControlClick',
	'ControlFocus',
	'ControlGet',
	'ControlGetFocus',
	'ControlGetPos',
	'ControlGetText',
	'ControlMove',
	'ControlSend',
	'ControlSendRaw',
	'ControlSetText',
	'CoordMode',
	'Critical',
	'DetectHiddenText',
	'DetectHiddenWindows',
	'Drive',
	'DriveGet',
	'DriveSpaceFree',
	'EnvAdd',
	'EnvDiv',
	'EnvGet',
	'EnvMult',
	'EnvSet',
	'EnvSub',
	'Exit',
	'ExitApp',
	'FileAppend',
	'FileCopy',
	'FileCopyDir',
	'FileCreateDir',
	'FileCreateShortcut',
	'FileDelete',
	'FileEncoding',
	'FileGetAttrib',
	'FileGetShortcut',
	'FileGetSize',
	'FileGetTime',
	'FileGetVersion',
	'FileInstall',
	'FileMove',
	'FileMoveDir',
	'FileRead',
	'FileReadLine',
	'FileRecycle',
	'FileRecycleEmpty',
	'FileRemoveDir',
	'FileSelectFile',
	'FileSelectFolder',
	'FileSetAttrib',
	'FileSetTime',
	'FormatTime',
	'GetKeyState',
	'gosub',
	'goto',
	'GroupActivate',
	'GroupAdd',
	'GroupClose',
	'GroupDeactivate',
	'Gui',
	'GuiControl',
	'GuiControlGet',
	'Hotkey',
	'IfEqual',
	'IfExist',
	'IfGreater',
	'IfGreaterOrEqual',
	'IfInString',
	'IfLess',
	'IfLessOrEqual',
	'IfMsgBox',
	'IfNotEqual',
	'IfNotExist',
	'IfNotInString',
	'IfWinActive',
	'IfWinExist',
	'IfWinNotActive',
	'IfWinNotExist',
	'ImageSearch',
	'IniDelete',
	'IniRead',
	'IniWrite',
	'Input',
	'InputBox',
	'KeyWait',
	'Loop',
	'Menu',
	'MouseClick',
	'MouseClickDrag',
	'MouseGetPos',
	'MouseMove',
	'MsgBox',
	'OnExit',
	'OutputDebug',
	'Pause',
	'PixelGetColor',
	'PixelSearch',
	'PostMessage',
	'Process',
	'Progress',
	'Random',
	'RegDelete',
	'RegRead',
	'RegWrite',
	'Run',
	'RunAs',
	'RunWait',
	'Send',
	'SendEvent',
	'SendInput',
	'SendLevel',
	'SendMessage',
	'SendMode',
	'SendPlay',
	'SendRaw',
	'SetBatchLines',
	'SetCapsLockState',
	'SetControlDelay',
	'SetDefaultMouseSpeed',
	'SetEnv',
	'SetFormat',
	'SetKeyDelay',
	'SetMouseDelay',
	'SetNumLockState',
	'SetRegView',
	'SetScrollLockState',
	'SetStoreCapslockMode',
	'SetTimer',
	'SetTitleMatchMode',
	'SetWinDelay',
	'SetWorkingDir',
	'Shutdown',
	'Sleep',
	'Sort',
	'SoundBeep',
	'SoundGet',
	'SoundGetWaveVolume',
	'SoundPlay',
	'SoundSet',
	'SoundSetWaveVolume',
	'SplashImage',
	'SplashTextOn',
	'SplitPath',
	'StatusBarGetText',
	'StatusBarWait',
	'StringCaseSense',
	'StringGetPos',
	'StringLeft',
	'StringLen',
	'StringLower',
	'StringMid',
	'StringReplace',
	'StringRight',
	'StringSplit',
	'StringTrimLeft',
	'StringTrimRight',
	'StringUpper',
	'Suspend',
	'SysGet',
	'Thread',
	'ToolTip',
	'Transform',
	'TrayTip',
	'URLDownloadToFile',
	'WinActivate',
	'WinActivateBottom',
	'WinClose',
	'WinGet',
	'WinGetActiveStats',
	'WinGetActiveTitle',
	'WinGetClass',
	'WinGetPos',
	'WinGetText',
	'WinGetTitle',
	'WinHide',
	'WinKill',
	'WinMaximize',
	'WinMenuSelectItem',
	'WinMinimize',
	'WinMove',
	'WinRestore',
	'WinSet',
	'WinSetTitle',
	'WinShow',
	'WinWait',
	'WinWaitActive',
	'WinWaitClose',
	'WinWaitNotActive',
	#
	'#Warn',
	'ListLines',
	'#KeyHistory',
	'#NoEnv',
	'Process',
	'#HotkeyInterval',
	'#MaxHotkeysPerInterval'
]

CommandsList = "#IfWinActive,#IfWinExist,#IfWinNotActive,#IfWinNotExist,#InputLevel,AutoTrim,BlockInput,break,ClipWait,catch,continue,Control,ControlClick,ControlFocus,ControlGet,ControlGetFocus,ControlGetPos,ControlGetText,ControlMove,ControlSend,ControlSendRaw,ControlSetText,CoordMode,Critical,DetectHiddenText,DetectHiddenWindows,Drive,DriveGet,DriveSpaceFree,EnvAdd,EnvDiv,EnvGet,EnvMult,EnvSet,EnvSub,Exit,ExitApp,FileAppend,FileCopy,FileCopyDir,FileCreateDir,FileCreateShortcut,FileDelete,FileEncoding,FileGetAttrib,FileGetShortcut,FileGetSize,FileGetTime,FileGetVersion,FileInstall,FileMove,FileMoveDir,FileRead,FileReadLine,FileRecycle,FileRecycleEmpty,FileRemoveDir,FileSelectFile,FileSelectFolder,FileSetAttrib,FileSetTime,FormatTime,GetKeyState,gosub,goto,GroupActivate,GroupAdd,GroupClose,GroupDeactivate,Gui,GuiControl,GuiControlGet,Hotkey,IfEqual,IfExist,IfGreater,IfGreaterOrEqual,IfInString,IfLess,IfLessOrEqual,IfMsgBox,IfNotEqual,IfNotExist,IfNotInString,IfWinActive,IfWinExist,IfWinNotActive,IfWinNotExist,ImageSearch,IniDelete,IniRead,IniWrite,Input,InputBox,KeyWait,Loop,Menu,MouseClick,MouseClickDrag,MouseGetPos,MouseMove,MsgBox,OnExit,OutputDebug,Pause,PixelGetColor,PixelSearch,PostMessage,Process,Progress,Random,RegDelete,RegRead,RegWrite,Run,RunAs,RunWait,Send,SendEvent,SendInput,SendLevel,SendMessage,SendMode,SendPlay,SendRaw,SetBatchLines,SetCapsLockState,SetControlDelay,SetDefaultMouseSpeed,SetEnv,SetFormat,SetKeyDelay,SetMouseDelay,SetNumLockState,SetRegView,SetScrollLockState,SetStoreCapslockMode,SetTimer,SetTitleMatchMode,SetWinDelay,SetWorkingDir,Shutdown,Sleep,Sort,SoundBeep,SoundGet,SoundGetWaveVolume,SoundPlay,SoundSet,SoundSetWaveVolume,SplashImage,SplashTextOn,SplitPath,StatusBarGetText,StatusBarWait,StringCaseSense,StringGetPos,StringLeft,StringLen,StringLower,StringMid,StringReplace,StringRight,StringSplit,StringTrimLeft,StringTrimRight,StringUpper,Suspend,SysGet,Thread,ToolTip,Transform,TrayTip,URLDownloadToFile,WinActivate,WinActivateBottom,WinClose,WinGet,WinGetActiveStats,WinGetActiveTitle,WinGetClass,WinGetPos,WinGetText,WinGetTitle,WinHide,WinKill,WinMaximize,WinMenuSelectItem,WinMinimize,WinMove,WinRestore,WinSet,WinSetTitle,WinShow,WinWait,WinWaitActive,WinWaitClose,WinWaitNotActive" + ",#Warn,ListLines,#KeyHistory,#NoEnv,Process,#HotkeyInterval,#MaxHotkeysPerInterval"

# исправление регистра
'''
def FixCase():
	for Key in CaseTable:
		Value = Key
		editor.rereplace(r'^([;~]?[\t ]?+)' + Key + r'\b', r'$1' + Value, re.IGNORECASE)

# исправление регистра
def FixCaseFunc(LineText, LineNumber, TotalLines):
	for Command in CaseTable:
		LineText = re.sub(r"^([;~]?(?:[\t ]+)?)" + Command + r"\b", r"\1" + Command, LineText, 0, re.IGNORECASE)
		editor.replaceWholeLine(LineNumber, LineText)
'''

def FixCaseFunc():
	for Command in CaseTable:
		editor.rereplace(r"^([;~]?(?:[\t ]+)?)" + Command + r"\b", r"\1" + Command, re.IGNORECASE)

# исправление запятых
def FixCommasFunc(LineText, LineNumber, TotalLines):
	# console.write(str(LineNumber) + '. ' + LineText + '\n')
	Match = re.search(r'^([;~]?(?:[\t ]+)?)(#?\w+\b)([\t ]{1,})([^\s])', LineText)
	# editor.gotoLine(LineNumber)
	# editor.scrollCaret()
	if Match:
		LeadingSpaces = Match.group(1)
		Command = Match.group(2)
		TrailingSpaces = Match.group(3)
		ParamsOrSomething = Match.group(4)
		Match = re.search(Command + r'\b', CommandsList, re.IGNORECASE)
		if Match:
			Match = re.search(r"^([;~]?(?:[\t ]+)?)" + Command + r"\b" + r"([\t ]{1,})([^\s]+)", LineText, re.IGNORECASE)
			if Match:
				MathSymbolsRegEx = r"\+\+|\-\-|\-\=|\+\=|\*\=|\/\=|\:\=|\.="
				Match = re.search(MathSymbolsRegEx, Match.group(3), re.IGNORECASE)
				if (not Match):
					LineText = re.sub(r"^([;~]?(?:[\t ]+)?)" + r"" + Command + r"\b" + r"([\t ]{1,})([^\s])", r"\1" + Command + r",\2\3", LineText, 0, re.IGNORECASE)
					# console.write(LineText)
			LineText = re.sub(Command + r"\b" + r",([\t ]+;)", Command + r"\1", LineText, 0, re.IGNORECASE)
			editor.replaceWholeLine(LineNumber, LineText)
			console.write(str(LineNumber) + '. ' + LineText)

def FixCommas():
	editor.forEachLine(FixCommasFunc)
	# editor.gotoPos(DocumentStartingPosition)
	console.write('Fix Commas for Commands:\tDone.\n')

def FixCase():
	# editor.forEachLine(FixCaseFunc)
	# editor.gotoPos(DocumentStartingPosition)
	FixCaseFunc()
	console.write('Fix Case for Commands:\t\tDone.\n')

def ReIndent():
	notepad.runMenuCommand('Синтаксисы', 'AutoHotkey (Indent)')
	editor.documentEnd()
	notepad.runPluginCommand('Indent By Fold', 'Reindent File')
	notepad.runMenuCommand('Синтаксисы', 'AutoHotkey')
	editor.gotoPos(DocumentStartingPosition)
	console.write('Fix Indentation for Code:\tDone.\n')

# First we'll start an undo action, then Ctrl-Z will undo the actions of the whole script
editor.beginUndoAction()

FixCommas()
FixCase()
ReIndent()

# End the undo action, so Ctrl-Z will undo the above actions
editor.endUndoAction()
# Turn the undo recorder back on.
editor.setUndoCollection(1)

notepad.runMenuCommand('Синтаксисы', 'AutoHotkey')

# editor.gotoPos(DocumentStartingPosition)

console.write('READY.')

